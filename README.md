# cf_ai_minimal_app

Minimal Cloudflare AI chat app using Workers AI (Llama), Durable Objects for memory, and a simple HTML UI.

## Requirements
- Node.js 18+
- `wrangler` (installed via devDependencies)
- Cloudflare account with Workers + AI enabled

## Features
- LLM: Workers AI Llama instruct model (configurable via `MODEL` var)
- Workflow/coordination: Durable Object `ChatRoom`
- User input: basic web chat UI served by the Worker
- Memory/state: last 20 messages persisted per room in Durable Object storage

## Quickstart
```bash
# Install deps
npm install

# Dev (opens at http://localhost:8788)
npm run dev

# Deploy to Cloudflare (requires login)
npm run deploy
```

### Configure Model
Default model is set in `wrangler.toml` as `MODEL`. To override at deploy time:
```bash
wrangler deploy --var MODEL=@cf/meta/llama-3.3-8b-instruct
```

## Files
- `wrangler.toml`: Worker config, AI binding, Durable Object binding
- `src/index.ts`: Worker entry + `ChatRoom` Durable Object
- `public/`: Static assets (currently unused; UI is inline HTML for simplicity)
- `README.md`: This file
- `PROMPTS.md`: Prompts used during development

## Local Development

### Setup
1. Clone the repository
2. Install dependencies:
```bash
npm install
```

### Running Locally
Start the development server in local mode:
```bash
npx wrangler dev --local --port 8788
```

Or use the npm script:
```bash
npm run dev
```

### Accessing the App
- Open `http://localhost:8788` in your browser
- Type a message and press Enter or click Send
- Responses are generated by Workers AI and conversation context is stored in the Durable Object

### Troubleshooting Local Development
- If port 8788 is in use, specify a different port: `npx wrangler dev --local --port 8789`
- If you get "Address already in use" errors, kill existing processes: `lsof -ti:8788 | xargs kill`
- Local mode uses remote AI binding (incurs usage charges) but local Durable Objects

## Deploy
Make sure you are logged in:
```bash
npx wrangler login
npm run deploy
```

## Notes
- This project intentionally keeps the UI minimal while providing full AI chat functionality
- Local development uses remote AI binding which incurs usage charges
- Conversation history is persisted in Durable Objects (last 20 messages per room)


